checkfortax(),refreshTax(),refreshDiscount(),displayTax();var monthes=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sept","Oct","Nov","Dec"],today=new Date,dd=String(today.getDate()).padStart(2,"0"),mm=String(today.getMonth()).padStart(2,"0"),yyyy=today.getFullYear();function readURL(t){if(t.files&&t.files[0]){var e=new FileReader;$(".blah3").hide(),$(".blah").show(),e.onload=function(t){$(".blah").attr("src",t.target.result)},e.readAsDataURL(t.files[0])}}function deleteRow2(t){t.parentElement.style.display="none"}function deleteRow(t){var e="#"+t.id;$(e).parent().parent().remove(),add_ammounts(),$("#table tbody").find("select").trigger("change"),$("#paid_amount_input").keyup()}function insertDecimal(t){return(t/100).toFixed(2)}function addItems(){$(".tab_row ").each(function(t){var e=$(this).find("input:eq(0)").val(),a=$(this).find("input:eq(1)").val();$(this).find("span:eq(2)").text(Number(e)*Number(a))}),add_ammounts(),finalltaxdiscountmath()}function calculat(t){var e=$(t).parent().parent().attr("id"),a=$("#"+e).find("select");$("#"+e).find("input").blur(function(){console.log(this);var t=$("#"+e).find("input:eq(0)").val(),n=$("#"+e).find("input:eq(1)").val(),o=Number(t)*Number(n);console.log(o),$("#"+e).find("span.ammounts_total").text(o.toFixed(0)),$(a).trigger("change"),add_ammounts(),finalltaxdiscountmath()})}function add_ammounts(){var ammounts=[];$(".tab_row:visible .ammounts_total").each(function(){ammounts.push(Number(this.innerText))}),$("#subtotal_txt").text(eval(ammounts.join("+"))),$("#paid_amount_input").keyup(),totalAmount()}function totalAmount(){$("#total_txt").text($("#subtotal_txt").text())}function printContent(){var t=$("#print_doc");$(".print_hide").hide(),$("#total_border").addClass("total_border");var e=$(t).html(),a=document.body.innerHTML;return document.body.innerHTML="<html><head><title></title></head><body><nav></nav>"+e+"</body>",window.print(),document.body.innerHTML=a,setTimeout(retunObje,5e3),!1}function editContent(){var t=$(".rrr").attr("colspan");$(".print_hide").fadeOut(),$("#navb").slideUp(),$(".returnPage").show();var e=openDatabase("my.db","1.0","My WebSQL Database",2097152);$("#tax_tbody_aa").html(" "),e.transaction(function(e){e.executeSql("SELECT name, value FROM taxvalues",[],function(e,a){if(a.rows.length>0){var n=Number(t)-1;console.log(n),$(".disco").attr("colspan",2),$(".print_hide2").fadeOut(),$(".rrr").attr("colspan",n),$(".ccd").attr("colspan",2)}})})}function showContent(){var t=$(".rrr").attr("colspan");$(".print_hide").fadeIn(),$("#navb").slideDown(),$(".returnPage").fadeOut();var e=openDatabase("my.db","1.0","My WebSQL Database",2097152);$("#tax_tbody_aa").html(" "),e.transaction(function(e){e.executeSql("SELECT name, value FROM taxvalues",[],function(e,a){if(a.rows.length>0){var n=Number(t)+1;$(".print_hide2").fadeIn(),$(".rrr").attr("colspan",n),$(".ccd").attr("colspan",1)}})}),checkfortax(),checkImage()}function checkImage(){"block"===$("#image").css("display")?$("#image22").hide():($("#image").hide(),$("#image22").show(),$("img#image22").css("display","block"))}function retunObje(){$("#downloading-loder").fadeOut("slow"),$(".returnPage").fadeOut(),$("#navb").slideDown(),$(".print_hide").fadeIn(),$(".print_hide2").fadeIn(),$(".ccd").attr("colspan",1),openDatabase("my.db","1.0","My WebSQL Database",2097152).transaction(function(t){t.executeSql("SELECT name, value FROM taxvalues",[],function(t,e){e.rows.length>0?($(".rrr").attr("colspan",4),$(".disco").attr("colspan",4)):($(".rrr").attr("colspan",2),$(".disco").attr("colspan",2))})}),checkfortax(),checkImage()}function generatePDF(){var t;if($("#exampleModalsave").modal("hide"),$("#downloading-loder").fadeIn("fast"),$("#filename").val()){t=$("#filename").val().replace(/[.,\s]/g,"")}else t="pdf";const e=document.getElementById("print_doc");var a={margin:.21,filename:t,image:{type:"jpeg",quality:1},html2canvas:{scale:13,quality:4,imageTimeout:0,logging:!0,letterRendering:!0,useCORS:!0},jsPDF:{unit:"in",format:[8.5,16.6],orientation:"portrait",floatPrecision:"smart"}};html2pdf().set(a).from(e).toContainer().toCanvas().toImg().toPdf().save(),setTimeout(retunObje,7e3)}function removSpaces(t){return t.replace(/ /g,"_")}function deleteTax(t){var e=openDatabase("my.db","1.0","My WebSQL Database",2097152);console.log();var a=$("#"+t.id).parent().parent().find("td:first").text();console.log(a),e.transaction(function(t){t.executeSql("delete from taxvalues where name=?",[a],function(t,e){console.log(e),console.info("Record Deleted Successfully!")},function(t,e){console.log(e)})},function(){},function(){jQuery(".calcit option").filter(function(){return $.trim($(this).text())===a}).remove(),$("[data-taxsub="+a+"]").remove()}),displayTax(),refreshTax(),checkfortax(),finalltaxdiscountmath()}function refreshTax(){var t=openDatabase("my.db","1.0","My WebSQL Database",2097152);$("#tax_tbody").html(" "),t.transaction(function(t){t.executeSql("SELECT name, value FROM taxvalues",[],function(t,e){if(e.rows.length>0)for(var a=0;a<e.rows.length;a++){var n=a+1;$("#tax_tbody").append(' <tr id="tax'+a+'"><th scope="row">'+n+"</th><td>"+e.rows.item(a).name+"</td><td>"+e.rows.item(a).value+'</td><td><i id="t_delete'+a+'" data-rowid="'+e.rows.item(a).rowid+'" style="margin-left: auto;" onclick="deleteTax(this)" class="fas fa-trash text-danger " data-toggle="tooltip" data-placement="right" title="Delete top row"></i></td></tr>')}})})}function displayTax(){var t=openDatabase("my.db","1.0","My WebSQL Database",2097152);$("#tax_tbody_aa").html(" "),t.transaction(function(t){t.executeSql("SELECT name, value FROM taxvalues",[],function(t,e){if(e.rows.length>0)for(var a=0;a<e.rows.length;a++){var n=a+1;"t_delete_aa"+a,$("#tax_tbody_aa").append(' <tr id="tax_aa'+a+'"><th scope="row">'+n+"</th><td>"+e.rows.item(a).name+"</td><td>"+e.rows.item(a).value+'</td><td><i onclick="taxTotal(this)" data-name="'+e.rows.item(a).name+'" data-value="'+e.rows.item(a).value+'"  id="t_delete_aa'+a+'" style="margin-left: auto; cursor: pointer" class="btn btn-success" data-toggle="tooltip" data-placement="right" title="Use Tax">Use This Tax</i><i onclick="undotaxTotal(this)" data-name="'+e.rows.item(a).name+'" data-value="'+e.rows.item(a).value+'" id="t_delete_ud'+a+'" style="margin-left: auto; cursor: pointer; display: none; "  class="btn btn-info ml-2" data-toggle="tooltip" data-placement="right" title="Use Tax">Undo</i></td></tr>')}})})}function tabletax(){var t=openDatabase("my.db","1.0","My WebSQL Database",2097152);$("#tax_tbody_aa").html(" "),t.transaction(function(t){t.executeSql("SELECT name, value FROM taxvalues",[],function(t,e){if(e.rows.length>0){var a=$(".tax-dropdown").length,n="table_tax_id_"+a;$(".tax-dropdown:last").html(" "),$(".tax-dropdown:last").each(function(){$(this).val();$(this).append(' <option class="op1" selected value="0">Choose</option>');for(var t=0;t<e.rows.length;t++)$(this).append('<option value="'+e.rows.item(t).value+'">'+e.rows.item(t).name+"</option>");$(".tax-dropdown:last").attr("id",n),a++})}})})}function taxTotal(t){var e=$("#total_txt").text();localStorage.setItem("oldTotal",e);var a=t.dataset.value;console.log(a,e),$("#"+t.id).parent().find("i:last").show(),$("#paid_amount_input").keyup()}function undotaxTotal(t){$("#total_txt").text(localStorage.getItem("oldTotal")),$("#"+t.id).hide(),$("#paid_amount_input").keyup()}function checkfortax(){openDatabase("my.db","1.0","My WebSQL Database",2097152).transaction(function(t){t.executeSql("SELECT name, value FROM taxvalues",[],function(t,e){e.rows.length>0?($(".no-tax-hide").show(),$(".no-extra-hide").show(),$(".rrr").attr("colspan",3),$("#subtotal_row").show(),$(".disco").attr("colspan",3)):($(".no-tax-hide").hide(),$(".no-extra-hide").hide(),$(".rrr").attr("colspan",2),$("#subtotal_row").hide(),$(".disco").attr("colspan",2),$(".discountclass").length>0&&$("#subtotal_row").show())})})}function calculateTaxTwo(e){var $spn=$(e).parent().find("span"),$selval=$(e).val(),$seltotal=$(e).parent().parent().parent().find("span:last").text(),$seltxt=e.options[e.selectedIndex].text;$spn.attr("data-seltax",$seltxt),$spn.text(Number($selval)/100*Number($seltotal));var tax_name=[];$(".calcit").each(function(){"Choose"!==this.options[this.selectedIndex].text&&tax_name.push(this.options[this.selectedIndex].text)});var hist={};tax_name.map(function(t){t in hist?hist[t]++:hist[t]=1});var db=openDatabase("my.db","1.0","My WebSQL Database",2097152);db.transaction(function(tx){tx.executeSql("SELECT name, value FROM taxvalues",[],function(tx,results){for(var i=0;i<results.rows.length;i++){var fff=[];$("[data-seltax="+results.rows.item(i).name+"]").each(function(){fff.push($(this).text())}),$(".tax_txt_"+results.rows.item(i).name).text(eval(fff.join("+")))}console.log(fff),fff.length=0})}),db.transaction(function(t){t.executeSql("SELECT name, value FROM taxvalues",[],function(t,e){if(e.rows.length>0)for(var a=0;a<e.rows.length;a++)tax_name.includes(e.rows.item(a).name)||$("."+e.rows.item(a).name).remove()})}),finalltaxdiscountmath()}function calculateTaxOne(t){var e=t.options[t.selectedIndex].text;if(0!==$(".tax-sub").length){if(0===$("."+e).length){var a=$("."+e).find("input:first").val();if(t.options[t.selectedIndex].text!==a)if(0!==!$("."+e).length)if("Choose"!==t.options[t.selectedIndex].text){var n='<tr data-taxsub="'+e+'" class="tax-sub '+e+'"><td style="border-bottom-color: #ffffff !important;border-left-color: #ffffff !important; border-top-color: #ffffff !important; border-right: none !important;" class="py-0 rrr" colspan="3"></td><td class="" style="padding: 6px 6px !important;border-left: none !important; border-right: none !important;"><label for="bs_subTotal" class="no-label"></label><input style="width: 85px;" type="text" value="'+e.toUpperCase().replace(/_/g," ")+':" class="no-border tax-input input_title_smn text-bold-placehoder" id="bs_subTotal" placeholder="'+e.toUpperCase()+':"></td> <td colspan="2" style="border-left: none !important; border-right: none !important;" class="text-bold-custom"><span><span>Ksh </span><span data-taxx="'+e+'"  class="xui tax_txt_'+e+'">'+t.value+"</span></span></td></tr>";$(n).insertAfter(".tax-sub:last")}else console.log("Choosen"),setTimeout(cvui,1e3);else console.log("exist")}}else{console.log("first");n='<tr data-taxsub="'+e+'" class="tax-sub '+e+'"><td style="border-bottom-color: #ffffff !important; border-left-color: #ffffff !important;  border-top-color: #ffffff !important; border-right: none !important; " class="py-0 rrr" colspan="4"></td><td class="" style="padding: 6px 6px !important;border-left: none !important; border-right: none !important;"> <label for="bs_subTotal" class="no-label"></label><input style="width: 85px;" type="text" value="'+e.toUpperCase()+':" class=" no-border tax-input input_title_smn text-bold-placehoder" id="bs_subTotal" placeholder="'+e.toUpperCase()+':"></td> <td style="border-left: none !important; border-right: none !important;" colspan="2" class="text-bold-custom"><span><span>Ksh </span><span data-taxx="'+e+'"  class="xui tax_txt_'+e+'">'+t.value+"</span></span></td></tr>";$(n).insertAfter(".tax-sub:last")}}function refreshDiscount(){var t=openDatabase("my.db","1.0","My WebSQL Database",2097152);$("#discount_tbody").html(" "),t.transaction(function(t){t.executeSql("SELECT name, value FROM discount",[],function(t,e){if(e.rows.length>0)for(var a=0;a<e.rows.length;a++){var n=a+1;$("#discount_tbody").append(' <tr id="discount'+a+'"><th scope="row">'+n+"</th><td>"+e.rows.item(a).name+"</td><td>"+e.rows.item(a).value+'</td><td><i id="discount_delete'+a+'" style="margin-left: auto;" onclick="deleteDiscount(this)" class="fas fa-trash text-danger " data-toggle="tooltip" data-placement="right" title="Delete discount"></i></td></tr>')}})})}function deleteDiscount(t){var e=openDatabase("my.db","1.0","My WebSQL Database",2097152);console.log();var a=$("#"+t.id).parent().parent().find("th:first").text();console.log(a),e.transaction(function(t){t.executeSql("delete from discount where rowid=?",[a],function(t,e){console.log(e),console.info("Record Deleted Successfully!")},function(t,e){console.log(e)})},function(){},function(){}),refreshDiscount(),displayDiscounts()}function displayDiscounts(){var t=openDatabase("my.db","1.0","My WebSQL Database",2097152);$("#tax_tbody_bb").html(" "),t.transaction(function(t){t.executeSql("SELECT name, value FROM discount",[],function(t,e){if(e.rows.length>0)for(var a=0;a<e.rows.length;a++){var n=a+1;$("#tax_tbody_bb").append(' <tr id="discount_bb'+a+'"><th scope="row">'+n+"</th><td>"+e.rows.item(a).name+"</td><td>"+e.rows.item(a).value+'</td><td><i onclick="makeDiscount(this)" data-name="'+e.rows.item(a).name+'" data-value="'+e.rows.item(a).value+'"  id="discount_delete_bb'+a+'" style="margin-left: auto; cursor: pointer" class="btn btn-success" data-toggle="tooltip" data-placement="right" title="Use Tax">Use This Discount</i><i onclick="undoDiscount(this)" data-name="'+e.rows.item(a).name+'" data-value="'+e.rows.item(a).value+'"  id="discount_delete_ud'+a+'" style="margin-left: auto; cursor: pointer; display: none;" class="btn btn-warning" data-toggle="tooltip" data-placement="right" title="Undo">Undo</i></td></tr>')}})})}function makeDiscount(t){var e=$("#total_txt").text();localStorage.setItem("oldTotalnew",e);var a=t.dataset.value,n=t.dataset.name,o=0;console.log(n),$("#"+t.id).parent().find("i:last").show(),"Percentage"===n?(o=(100-Number(a))/100*Number(e),console.log(o),$("#total_txt").text(o),$("#paid_amount_input").keyup()):"Cash"===n&&(console.log(n),o=Number(e)-Number(a),console.log(o),$("#total_txt").text(o),$("#paid_amount_input").keyup())}function undoDiscount(t){$("#total_txt").text(localStorage.getItem("oldTotalnew")),$("#"+t.id).hide(),$("#paid_amount_input").keyup()}function finalltaxdiscountmath(){setTimeout(cvui,1e3)}function cvui(){var itma=[],xui=document.getElementsByClassName("xui");for(v of xui)itma.push(Number(v.innerText));xui.length>0?($("#total_txt").text(Number($("#subtotal_txt").text())+eval(itma.join("+"))),itma.length=0):(itma.push(0),$("#total_txt").text(Number($("#subtotal_txt").text())+eval(itma.join("+")))),$("#paid_amount_input").keyup()}today=monthes[Number(mm)]+"/"+dd+"/"+yyyy,$("#bs_date_no_text").attr("placeholder",today),$("#bs_date_no_text").attr("value",today),$('[data-toggle="tooltip"]').tooltip(),$("#invoice_add").click(function(t){console.log("this"),$("#clone_me div:first").clone().insertAfter("#clone_me > div:last").find("input").attr("placeholder","-----").parent().parent().append('<i style="margin-left: auto;" onclick="deleteRow2(this)" class="fas fa-trash text-danger print_hide" data-toggle="tooltip" data-placement="right" title="Delete top row"></i>'),$('[data-toggle="tooltip"]').tooltip()}),$("#addrow").click(function(t){var e="deleteButton"+$("#table tbody tr:not(:nth-last-child(3))").length,a=($("#table tbody tr:not(:nth-last-child(3))").length,"trow"+$("#table tbody tr:not(:nth-last-child(3))").length),n="ckk"+($(".table_contents").length+1);$("#table tbody tr:first").clone().insertAfter(".tab_row:last").find("th:last").append('<button data-toggle="tooltip" data-placement="right" title="Delete this row" onclick="deleteRow(this)" id="'+e+'" class="btn btn-sm btn-danger"><i class="fas fa-trash-alt  print_hide"></i></button>').parent().attr("id",a).find(".table_contents").attr("id",n).parent().parent().find("th:first p").text("New Product").parent().parent().parent().find("th:nth-child(2) input").val(1).parent().parent().find("th:nth-child(3) input").val(100),$("#"+e).parent().parent().find(".seltx").text(0),$("#"+e).parent().parent().find(".seltx").attr("data-seltax",""),addItems(),add_ammounts(),tabletax(),vuv(),finalltaxdiscountmath()}),addItems(),add_ammounts(),$('input[type="checkbox"]').on("click",function(){var t=$(this).prop("checked");!1===(t=!0!==t)?($(".checkbox-click-hide").fadeIn(),$("#labellll").text("on")):!0===t&&($(".checkbox-click-hide").fadeOut(),$("#labellll").text("off"))}),$("#paid_amount_input").keyup(function(t){let e=$(this).val();$(".paidamm").text(e);let a=$("#total_txt").text(),n=Number(a)-e;$("#balance_duee").text(n.toFixed(0))}),$("#tax_form_submit").click(function(t){var e=$("#tax_input").val(),a=removSpaces($("#tax_name").val()),n=openDatabase("my.db","1.0","My WebSQL Database",2097152);0===e.length&&0===a.length?$("#alert_dangerr").fadeIn():($("#alert_dangerr").fadeOut(),$("#spinner").show(),$(".tax-dropdown").each(function(){$(this).append('<option value="'+e+'">'+a+"</option>")}),n.transaction(function(t){t.executeSql("SELECT * FROM taxvalues WHERE name=?",[a],function(t,n){0===n.rows.length?(t.executeSql("INSERT INTO taxvalues (name, value) VALUES (?,?)",[a,e]),$("#alert_success").fadeIn(),$("#spinner").fadeOut()):($("#alert_exists").show(),$("#spinner").fadeOut())})})),displayTax(),refreshTax(),checkfortax()}),checkfortax(),tabletax(),$("#discount_form_submit").click(function(t){checkfortax();var e=$("#discount_value").val(),a=$("#discount_name").val(),n=$("#subtotal_txt").text(),o=0;("Percentage"===a?o="-"+Number(e/100)*Number(n):"Cash"===a&&(o="-"+e),0!==$(".discountclass").length)?e<=0?$(".discountclass").remove():$(".discountclass").find(".doit").text(o):e>0&&$('<tr class="discountclass tax_sub"><td style="border-bottom-color: #ffffff !important; border-left-color: #ffffff !important; border-top-color: #ffffff !important; border-right: none !important;" class="py-0 disco" colspan="4"></td><td class="" style="padding: 6px 6px !important;border-left: none !important; border-right: none !important;"><label for="bs_subTotall" class="no-label"></label><input style="width: 85px;" type="text" value="Discount:" class=" no-border tax-input input_title_smn text-bold-placehoder" id="bs_subTotall" placeholder="Discount:"></td><td colspan="2" style="border-left: none !important; border-right: none !important;" class="text-bold-custom"><span>Ksh </span><span class="xui doit">'+o+"</span></td></tr>").insertAfter("#subtotal_row");finalltaxdiscountmath()}),displayDiscounts();var $right=$("#right"),$left=$("#left"),$workTitle=$("#work-title");$("#Right-Logo").click(function(){$left.fadeOut(function(){$right.fadeIn(),$workTitle.fadeIn()})}),$("#Left-logo").click(function(){$right.fadeOut(function(){$workTitle.fadeOut(),$left.fadeIn()})}),$(".modal-header").on("mousedown",function(t){var e=$(this),a=t.pageX-e.offset().left,n=t.pageY-e.offset().top;$("body").on("mousemove.draggable",function(t){e.closest(".modal-dialog").offset({left:t.pageX-a,top:t.pageY-n})}),$("body").one("mouseup",function(){$("body").off("mousemove.draggable")}),e.closest(".modal").one("bs.modal.hide",function(){$("body").off("mousemove.draggable")})}),$("#image").draggable(),$("#img_label22>#mydropdown"),$(".dropdown-keep-open").on("hide.bs.dropdown",function(t){if(!t.clickEvent)return!0;var e=$(t.clickEvent.target);return!(e.hasClass("dropdown-keep-open")||e.parents(".dropdown-keep-open").length)});